/* Staff */

    DROP TABLE STAFF;

    CREATE TABLE STAFF (
        EmpNo INTEGER PRIMARY KEY AUTOINCREMENT,
        Fname VARCHAR(50) NOT NULL,
        Minit CHAR(1),
        Lname VARCHAR(50) NOT NULL,
        Ssn CHAR(9) UNIQUE,
        Gender CHAR(1) CHECK (Gender = 'M' OR Gender = 'F'),
        EmpType CHAR(4) NOT NULL CHECK (EmpType = 'PHYS' OR EmpType = 'NURS' OR EmpType = 'SURG' OR EmpType = 'SUPP'),
        Title VARCHAR(50) NOT NULL,
        Salary INTEGER,
        Specialty VARCHAR(50) CHECK (Specialty IN ('Cardiology','Dermatology','Gastroenterology', 'Orthopedics', 'Neurology', 'Ophthalmology', 'Otolaryngology', 'Pediatrics', 'Obstetrics and Gynecology', 'Urology', 'Endocrinology', 'Rheumatology', 'Pulmonology', 'Hematology', 'Infectious Disease', 'Emergency Medicine', 'Plastic Surgery', 'Radiology', 'Anesthesiology', 'Pathology')),
        NurseGrade INTEGER,
        YrsNursingExp INT,
        Addr VARCHAR(100),
        City VARCHAR(40),
        StateProv CHAR(40),
        ZIP VARCHAR(20),
        Country CHAR(40),
        Phone VARCHAR(10),
        CHECK ((EmpType != 'SURG' AND Salary IS NOT NULL AND Salary >= 25000 AND Salary <= 300000) OR (EmpType = 'SURG' AND Salary IS NULL)),
        CHECK (((EmpType = 'PHYS' OR EmpType = 'SURG') AND Specialty IS NOT NULL) OR ((EmpType = 'NURS' OR EmpType = 'SUPP') AND Specialty IS NULL)),
        CHECK ((EmpType = 'NURS' AND NurseGrade IS NOT NULL AND NurseGrade >= 1) OR (EmpType != 'NURS' AND NurseGrade IS NULL)),
        CHECK ((EmpType = 'NURS' AND YrsNursingExp IS NOT NULL AND YrsNursingExp >= 0) OR (EmpType != 'NURS' AND YrsNursingExp IS NULL))
    );

    INSERT INTO STAFF (Fname, Minit, Lname, Ssn, Gender, EmpType, Title, Salary, Specialty, NurseGrade, YrsNursingExp, Addr, City, StateProv, ZIP, Country, Phone) VALUES
        ('Lydia', 'A', 'Brown', '123456789', 'F', 'SUPP', 'Chief of Staff', 120000, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
        ('Jane', 'B', 'White', '111222333', 'F', 'PHYS', 'General Practitioner', 125000, 'Pathology', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
        ('Mark', 'C', 'Green', '333222111', 'M', 'SURG', 'Surgeon', NULL, 'Cardiology', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
        ('Tony', 'D', 'Scarlet', '987654321', 'M', 'NURS', 'Lead Nurse', 100000, NULL, 5, 12, NULL, NULL, NULL, NULL, NULL, NULL);

/* Trigger to prevent update of EmpNo or Title on Employee 1 */

CREATE TRIGGER CHECK_EMPNO1_UPDATE
BEFORE UPDATE ON STAFF
FOR EACH ROW
WHEN (OLD.EmpNo = 1 AND NEW.EmpNo != 1) OR (OLD.EmpNo = 1 AND New.Title != 'Chief of Staff')
    BEGIN
        SELECT RAISE (ABORT, 'Employee 1 must be the Chief of Staff and cannot be deleted.');
    END;

/* Trigger to prevent deletion of Employee 1 */

CREATE TRIGGER CHECK_EMPNO1_DELETE
BEFORE DELETE ON STAFF
FOR EACH ROW
WHEN (OLD.EmpNo = 1)
    BEGIN
        SELECT RAISE (ABORT, 'Employee 1 cannot be deleted.');
    END;




