/* Contracts for Surgeons */

    DROP TABLE SURG_CONTRACT;

    CREATE TABLE SURG_CONTRACT (
        EmpNo INTEGER PRIMARY KEY, 
        ContractType VARCHAR(20) NOT NULL CHECK (ContractType IN ('Independent', 'Partnership', 'Call Coverage', 'Research', 'Consulting')),
        LengthYrs INTEGER NOT NULL,
        FOREIGN KEY (EmpNo) REFERENCES STAFF(EmpNo)
            ON UPDATE CASCADE
            ON DELETE CASCADE
    );

/* Trigger to make sure a newly inserted Contract's EmpNo has an EmpType of 'SURG' */

    DROP TRIGGER CHECK_CONTRACT_EMP_INSERT;

    CREATE TRIGGER CHECK_CONTRACT_EMP_INSERT
    BEFORE INSERT ON SURG_CONTRACT
    FOR EACH ROW
    WHEN NOT EXISTS (
        SELECT 1 FROM STAFF WHERE EmpNo = NEW.EmpNo AND EmpType = 'SURG'
    )
    BEGIN
        SELECT RAISE (ABORT, 'The selected Employee must be a Surgeon.');
    END;

/* Trigger to make sure an updated Contract's EmpNo has an EmpType of 'SURG' */

    DROP TRIGGER CHECK_CONTRACT_EMP_UPDATE;

    CREATE TRIGGER CHECK_CONTRACT_EMP_UPDATE
    BEFORE UPDATE ON SURG_CONTRACT
    FOR EACH ROW
    WHEN NOT EXISTS (
        SELECT 1 FROM STAFF WHERE EmpNo = NEW.EmpNo AND EmpType = 'SURG'
    )
    BEGIN
        SELECT RAISE (ABORT, 'The selected Employee must be a Surgeon.');
    END;