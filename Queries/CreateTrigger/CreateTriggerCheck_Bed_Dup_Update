/* Trigger to make sure that no Bed record is being updated for the same clinic, wing, nursing unit, room no, and bed */

DROP TRIGGER CHECK_BED_DUP_UPDATE;

CREATE TRIGGER CHECK_BED_DUP_UPDATE
BEFORE UPDATE ON BED
FOR EACH ROW
WHEN EXISTS (
    SELECT 1 FROM BED WHERE Clinic = NEW.Clinic AND Wing = NEW.Wing AND NurseUnit = NEW.NurseUnit AND RoomNo = NEW.RoomNo AND Bed = NEW.Bed
)
BEGIN
    SELECT RAISE (ABORT, 'The selected combination of clinic, wing, nursing unit, room, and bed already exists.');
END;