/* Trigger to make sure that medication A and medication B in a newly created medication interaction are not the same value */

DROP TRIGGER CHECK_MED_DUP_INSERT;

CREATE TRIGGER CHECK_MED_DUP_INSERT
BEFORE INSERT ON MED_INTERACT
FOR EACH ROW
WHEN (NEW.MedA = NEW.MedB) OR EXISTS (
    SELECT 1 FROM MED_INTERACT WHERE (MedA = NEW.MedA AND MedB = NEW.MedB) OR (MedA = NEW.MedB AND MedB = NEW.MedA)
)
    BEGIN
        SELECT RAISE(ABORT, 'Medicine A and Medicine B is either set to the same value, or the combination of values entered already exists');
    END;