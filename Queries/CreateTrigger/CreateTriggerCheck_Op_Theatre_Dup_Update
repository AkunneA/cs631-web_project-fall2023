/* Trigger to make sure that no updated operating theatre has the same clinic and theatre combination */

DROP TRIGGER CHECK_OP_THEATRE_DUP_UPDATE;

CREATE TRIGGER CHECK_OP_THREATRE_DUP_UPDATE
BEFORE UPDATE ON OP_THEATRE
FOR EACH ROW
WHEN EXISTS (
    SELECT 1 FROM OP_THEATRE WHERE Clinic = NEW.Clinic AND Theatre = NEW.Theatre
)
BEGIN
    SELECT RAISE (ABORT, 'The selected Operating Theatre already exists.');
END;